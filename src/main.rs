//!A simple library for elementary number theory and arbitrary precision arithmetic. 

use std::{thread, time};



pub mod traits;
pub mod byte;
pub mod twobytes;
pub mod fourbytes;
pub mod eightbytes;
pub mod sixteenbytes;   
    mod fjprime32;
    mod fjprime64;
    mod primes;
    
    // computational speed 193.483187015s for primality checks in the interval [0;10^9]
 pub mod arithmetic;
    
 pub   use crate::traits::NumberTheory;
 pub   use crate::arithmetic::mpz::Mpz;
 pub   use crate::arithmetic::sign::Sign;

 use std::str;
 
 fn note(x:&str,y:&str){
   use std::fs::File;
   use std::io::Write;
  let mut file = File::create(y).expect("Whoopsie, ran out of paper . . .");

   println!("My pen is ready . . . ");
   file.write_all(x.as_bytes()).expect("Whoopsie ran out of ink . . .");
}
 
 fn sqrt_precision(x: Mpz, places: u64, linelen: usize) -> String {
      let lead = x.sqrt().to_string();
      let time = std::time::Instant::now();
       let dec = Mpz::from_u64(5).pow(places*2).shl((places*2) as usize);
       let stop = time.elapsed();
      // println!("{:?}", stop);
      let tmp = x.ref_product(&dec).sqrt().to_string(); 
      let len = tmp.len();
      let trailing = tmp.as_bytes();

           let mut result : Vec<u8> = vec![];
           for i in lead.as_bytes(){
             result.push(*i)
           }
           result.push(46); // inserts decimal point  46  10
           let len = trailing.len();
           for i in 0..len{//.as_bytes()[lead.len()..].iter(){
            if i%linelen == 0 && i > 0{
              result.push(10)
            }
             result.push(trailing[i])
           }
           
           String::from_utf8(result).unwrap()
 }
 
 
 fn sprp_32(p: u32, base: u32)->bool{// checks if base^p = 1 mod p  or base^(d*2^n)= -1 for some n  
     let zeroes = (p-1).trailing_zeros() as u32; // Breaks number down to p= d*2^n -1
     let d = (p-1)/ (1<<zeroes);
     let mut x = base.mod_pow(&d,&p); // base^d mod p
     if x == 1u32 || x==p-1{   // checks if base^p = 1 mod p  or base^(d*2^n)= -1
       return true
       }
    for _ in 0..zeroes-1{// checks for all d*2^zeroes. One is subtracted since d*2^n was already checked above
     x = x.quadratic_residue(&p);
     if x == p-1 {       // if any d*2^zeroes = p-1  then it passes
       return true
     }
    }
    return false        // otherwise it fails
 }
 
 fn trial_prime(x: u32, base: u32) -> bool{
    for i in crate::primes::PRIMELIST[..30].iter(){
      if x == *i as u32 {return true}
      if x % *i as u32 == 0 {return false}
    }
    if sprp_32(x,base){
      match PSEUDOPRIMES.binary_search(&x) {
      Ok(y) => return false,
        Err(y) => return true,
      };
    //return true}
   }
    return false
 }
 
 const PSEUDOPRIMES : [u32;2069] = [
42799,49141,88357,90751,104653,130561,196093,253241,256999,271951,280601,
357761,390937,458989,486737,489997,514447,580337,741751,838861,873181,
877099,916327,976873,983401,1016801,1082401,1194649,1207361,1251949,1252697,
1302451,1325843,1357441,1373653,1441091,1493857,1507963,1509709,1530787,1678541,
1730977,1811573,1876393,1969417,1987021,2004403,2081713,2181961,2205967,2264369,
2269093,2284453,2304167,2387797,2510569,2746477,2748023,2757241,2811271,2909197,
2976487,3090091,3116107,3125281,3375041,3400013,3429037,3539101,3567481,3605429,
3898129,4181921,4188889,4360621,4469471,4513841,4835209,4863127,5016191,5044033,
5173169,5173601,5256091,5489641,5590621,5672041,5919187,6140161,6226193,6233977,
6334351,6368689,6386993,6787327,6836233,6952037,7306261,7306561,7462001,7674967,
7759937,7820201,7883731,8036033,8095447,8384513,8534233,8725753,9006401,9056501,
9073513,9371251,9564169,9567673,9729301,9774181,9863461,10323769,10386241,10425511,
10610063,10712857,10763653,10974881,11081459,11335501,11541307,11585293,11777599,12263131,
12327121,13057787,13338371,13446253,13635289,13694761,13747361,14179537,14324473,14709241,
14794081,14865121,15101893,15139199,15188557,15220951,15479777,15802681,15976747,15978007,
16070429,16132321,16324001,16360381,16705021,16773121,16822081,16853077,16879501,17116837,
17134043,17208601,17327773,17375249,17585969,18073817,18366937,18443701,18454921,18535177,
18653353,18740971,19328653,19404139,19471033,19607561,20261251,20417311,20647621,21303343,
21306157,21359521,21400481,21623659,22075579,22087477,22591301,22669501,22849481,22953673,
23464033,23577497,23734901,23828017,23872213,23963869,24214051,25080101,25326001,25629913,
26377921,26821601,26877421,27108397,27219697,27271151,27279409,27331921,27380831,27392041,
27509653,27664033,27798461,27808463,28325881,28527049,28572961,29111881,29214541,29581501,
30022129,30185569,30219757,30295141,30388753,30576151,30662497,30740417,30881551,30894307,
31166803,31436123,33627301,33704101,34003061,34856167,35576599,35820937,35851037,36307981,
36861901,36919681,37109467,37439201,38010307,38046817,38118763,38210323,39465091,39655153,
40629601,40782589,40827473,40987201,41121433,41604109,41642681,41662297,41840809,42485119,
42623017,42984589,43363601,43661257,44314129,45100177,45414433,45819541,46325029,46517857,
46679761,47220367,47903701,47918581,48191653,48269761,48316969,48448661,48551161,49303801,
49411801,50155733,51129781,51302353,51500521,52072021,52119289,52204237,53399449,53656021,
53675623,53695721,53711113,54029741,54449431,55109401,55318957,55729957,56420033,58422409,
58449847,58509977,59631211,59840537,59913157,60155201,60352921,60547831,60566431,60581401,
60696661,60738257,61201009,61219789,61377109,61832377,63001801,63065281,63167743,63318169,
63346999,63388033,64605041,65254393,65301013,65359477,66096253,67194401,67642513,68102641,
68154001,68165761,68512867,69030901,69128641,69176647,69228967,69231061,69485281,69885649,
70149631,70593931,70728121,71734417,72498253,72543547,73562833,73645001,74411131,74927161,
75140137,75565873,76725091,76745101,77533123,77812153,77817979,78939089,79398901,79417801,
79786523,80375707,80556337,80687881,81433591,82506439,82870517,83204801,84421081,84487457,
84998503,85519337,86027329,86530621,86999837,87499651,87694261,88368853,89308771,91433281,
93431521,93541537,94316401,94502701,95451361,95452781,96618397,96904081,96925921,97496449,
97796953,97863529,97924217,99115297,99486889,99789673,100463443,100618933,100943201,101270251,
101276579,102004421,102678031,102690677,104078857,105305443,105919633,106485121,106743073,107543333,
108596953,109437751,110139499,110312773,110717861,111654401,112402981,112828801,114305441,114701341,
115039081,115174681,115804501,115873801,116090081,116617289,117987841,119204809,119558011,120296677,
120517021,121472359,122166307,123671671,123987793,124145473,126132553,127050067,128079409,128124151,
128665319,128987429,129256273,129357061,131567929,131938561,132332201,132338881,132575071,133216381,
133302781,133467517,134696801,134767153,135263269,135308881,135969401,136043641,136661201,137415821,
137763037,138030721,139487041,140197051,143168581,145348529,146156617,146884393,147028001,147287141,
148109473,148910653,149389633,150960239,150988753,151533377,152716537,153369061,153754873,153928133,
154287451,156114061,156532799,157069189,157405249,157725829,158068153,158192317,158397247,158496911,
158895281,160348189,160491329,160587841,160672201,161304001,162026869,162067441,162690481,163442551,
165224321,165938653,166082309,166827943,167579497,167692141,167881121,168566501,169655641,170782921,
172116181,174479729,176030977,176597821,177927641,177951973,179285137,179820257,180497633,180703451,
181285537,181542601,181647497,182383111,183677341,184411567,186183469,187667969,187761241,189714193,
189738361,190382161,190913297,191233813,191981609,192346153,192857761,193330237,193949641,194556451,
196035001,196049701,198982759,199674721,200143351,202130197,203505697,204582457,205057561,206304961,
206504033,206529737,207008569,207030541,207477001,207618781,208051201,208969223,210842113,213035761,
214852609,214858717,215436241,217875571,218642029,218947121,220531501,220883521,221368153,222630193,
223449463,223625851,223782263,225853633,226359547,226450297,227444101,227475481,228652201,229589413,
230357761,231383461,232771501,235426913,235928071,237791143,238001653,240068041,240785047,242650717,
244883981,245006623,245950561,246099317,246282511,246434761,247318957,247416101,250958401,251663837,
252853921,253610281,253893397,255416897,257590661,258020473,258043229,259765747,260156101,260518801,
260963389,261703417,262979501,264269449,265020001,270525737,271272569,271763467,271950829,273480637,
274701913,274919401,275619961,276131137,276638321,280885153,282471853,282769771,284166877,284301751,
284736091,284834299,287160301,287449091,288099001,288117721,288735277,290643601,290953921,292902481,
293847721,295419097,298212601,299736181,301413001,302635351,307694323,307972801,310978027,311177213,
311411629,311655829,311671361,312408113,312614021,314184487,315034513,315351521,317365933,317796119,
319440769,319726177,320326003,321324589,322469701,322941881,324477697,325546873,326266051,326405713,
326695141,327398009,328302901,329153653,330198331,331658081,331934989,337135501,337420679,337665901,
338125537,338458807,339492169,341958121,341994131,343017529,344201441,344255551,344776301,346080391,
348989101,349752913,350031973,351058753,352802803,356836819,357872971,358416577,359394751,359727073,
360145633,360787771,361312337,363170837,365077373,366487201,367559501,368016949,369667561,371011801,
371611153,372167101,373533617,373669453,373906513,374988661,376957153,377192353,377334497,377806687,
377869031,385319089,390612221,392679737,393611653,394723177,399156661,399302581,399647221,403095967,
405739681,405782623,407889161,410613809,410680357,412836689,413429801,414216461,414368641,415204501,
415476343,417779909,418044563,418226581,418616161,418617281,418667401,419184481,421942951,422928101,
423465001,424411501,425967301,426770437,426783811,427294141,428180191,429135841,429509837,430046857,
430646401,430733701,435016187,435993301,437462101,437866087,439309261,441650591,441758461,442050577,
442181291,446414621,450807481,450866021,453366029,453967739,455198563,460251733,461151121,461272267,
462587329,462639409,464012033,464955857,466290949,466758181,467100937,470268137,470644021,471535373,
473581057,475723849,478614067,480668347,482488393,483006889,483029821,486902929,487896601,488585521,
489994201,490950461,493108481,494288677,495909871,496560349,497148599,497285713,498662561,498706651,
500747293,501172241,504870241,505473263,505532773,505798213,506349421,507142567,508606771,509302873,
509551201,510925609,511215521,511611673,514738981,516764063,517662001,518216201,518548801,522758233,
523756711,528220117,531681281,533429881,534782293,535252867,535428577,536114197,536342419,536870911,
540621181,540654409,540680141,544861633,545550433,546117301,546322201,548989561,550132741,550230409,
550635373,550853137,551313001,553027201,554487121,554599051,555321007,556069849,556095433,556114609,
558235109,558900821,561448487,562367821,564298489,564689381,565664761,567358513,568902001,570941881,
572123521,572228929,572567353,572936869,574998841,576724219,577210181,577352641,577613261,579956653,
581618143,582799951,585261637,586706821,587343541,588049001,592467451,592468777,593682169,593728489,
597537361,599135767,600893921,601606487,602379181,609361567,609813781,611770513,611812321,612006253,
613849601,615361183,616280897,617087701,619239457,620544961,620755537,621769669,626717471,627886657,
628868467,629134081,630811513,631767943,631974613,633289807,635155291,635291077,635319361,636337073,
636936697,638837761,639807781,640650931,640977373,643036321,643552909,644457551,644731357,645556481,
651151801,651514753,653260633,660095641,660754117,661122881,661207177,662134201,663760681,672103001,
673778827,676359391,678481693,680983817,681124207,682528687,687741401,693456521,696998251,698192041,
698819711,702683101,705303457,705351583,707691601,709409993,710721001,714490481,717096641,717653129,
717831211,722955773,724160251,724969087,725508241,731276521,732805681,739444021,740988151,741214237,
742017181,745493761,745745461,746331041,747406801,750632137,751705597,753233717,753574537,753594001,
756205633,756271909,758581651,758687581,758901701,759252367,763907741,764033999,764240611,765378241,
766823797,770909107,770937931,771337891,773131927,773807401,775368901,775896181,776443769,777218989,
781471001,782823281,784450393,784777393,784783477,784966297,787085857,787209277,788046901,790453049,
791118043,794201333,796072003,796200901,796560703,797834017,799630753,799898833,799916101,801093011,
801227269,801866647,804978721,805771501,809790881,811607777,811730923,816024161,816215401,819466201,
822018961,826004467,830664451,831933901,832048447,833610751,839268139,839280691,839908217,840749761,
841217653,842785841,842824981,843161887,844545271,846961321,848090377,849548671,854094781,859096477,
862678081,867022747,867110501,867638201,868111597,868691401,870985223,871157233,878940833,879995689,
880870513,880922657,883276549,884304037,888868441,893692819,894264337,899019353,900736411,902566501,
903108821,903390643,905040953,907378669,907670501,910202509,914906539,921858631,923437213,926756881,
927106561,929159941,932148253,936421141,938376181,946034057,947878081,949317217,949697233,952893881,
954924013,958131157,960946321,962489557,962523169,965501857,967266451,967287751,968283247,970586713,
974113601,974471243,977483449,979363153,980056507,981484561,994133479,995586373,998489017,998590601,
998596741,998724481,999828727,1005833971,1006800829,1008839999,1009025263,1009140161,1011319501,1011333061,
1011570457,1011909271,1012438391,1013833153,1020515761,1022336611,1027744453,1028494429,1034958601,1040234231,
1054999441,1056121453,1057426651,1065602281,1069388497,1070941987,1072898711,1073288581,1073484823,1078467589,
1081798061,1084241341,1084444481,1094042321,1097416321,1098743563,1100624857,1102573501,1104194521,1105038871,
1106529761,1106595493,1108135381,1109304913,1110582947,1111205873,1111939201,1112671603,1116379301,1117202557,
1117828001,1117890019,1119412321,1120981021,1121176981,1123406047,1123625501,1124396521,1130933429,1134367777,
1140573601,1142466151,1147434289,1151670001,1153164097,1154987209,1156761911,1157839381,1160844821,1163227759,
1165717129,1166598217,1168221121,1168256953,1180970407,1181566219,1183338241,1184554801,1186325981,1187235193,
1191153937,1192314817,1192903531,1193557093,1196852273,1202142061,1204205449,1205772499,1209998077,1210653541,
1213619761,1217823517,1217924159,1220114377,1221127013,1222861271,1223531677,1223941657,1226855293,1229491063,
1229751667,1230446653,1232445677,1235188597,1236313501,1236442421,1238825569,1242171349,1254277909,1255665613,
1265477791,1267345081,1270489621,1270667353,1272866167,1282568741,1286298263,1296613501,1297443913,1301926081,
1302745481,1307823661,1308998741,1309983901,1310329567,1312332001,1312573123,1313396221,1318717531,1319992181,
1320793813,1321058213,1323668917,1325172421,1325329297,1328256247,1331973329,1344597577,1344975721,1345514101,
1350685001,1352453257,1356328121,1357459183,1362463807,1362515701,1366608377,1368769681,1375322101,1378646179,
1383283129,1385656829,1386705433,1391890033,1394640941,1397357851,1398883201,1400859847,1404008369,1404253369,
1406826241,1409372779,1414154827,1414529533,1421475031,1424503849,1425860101,1426319563,1427771089,1438648993,
1440922891,1441678411,1442945689,1443388481,1446818651,1448921633,1454282449,1456527461,1457378449,1461307717,
1463065501,1463178817,1464568381,1465908193,1465945417,1468540477,1468824787,1469960377,1470080501,1470650851,
1481626513,1485061471,1486564301,1493114149,1495190699,1497965713,1499971457,1499989177,1500142001,1502171117,
1502403121,1503240559,1503705601,1504832033,1509156013,1515175087,1517039371,1518290707,1521221473,1526732803,
1529648231,1529819971,1530495289,1532419099,1532569681,1532755369,1534063081,1535020133,1536251047,1537433899,
1537641691,1538012449,1539583921,1541955409,1545019813,1545177581,1546106773,1546508057,1547140841,1547712601,
1554270481,1565893201,1566594551,1567830241,1568916311,1574362441,1577983489,1578009401,1581576641,1582783777,
1583230241,1586436193,1593706201,1595647351,1603765021,1603810561,1603994701,1609916491,1614508267,1617795181,
1617921667,1620646177,1630062253,1631314609,1633044241,1637434657,1637930893,1638294661,1639846391,1641971701,
1644637051,1647225529,1648076041,1649430889,1650265549,1650682153,1656229921,1661202113,1668037621,1671603667,
1672125131,1675978193,1678274581,1679130641,1685433413,1686001861,1692605041,1695158921,1700250049,1709909293,
1714322377,1716774481,1718013133,1718088301,1721061497,1721986313,1725675451,1726372441,1731048937,1734059291,
1735071913,1740214841,1743166441,1746721681,1750412161,1760014561,1769267761,1770236893,1773582977,1776820033,
1779649381,1784638309,1785843547,1787934881,1790023861,1791426787,1792442737,1792588813,1794814103,1802510669,
1803768091,1804906517,1805947313,1809888967,1816408273,1819829749,1835114401,1844028961,1846171781,1850233897,
1850598961,1854940231,1856689453,1860373241,1862880401,1873177693,1878691753,1879111697,1879775501,1894909141,
1894955311,1899081757,1905958891,1909566073,1910134309,1911197947,1912950241,1914303841,1916987593,1917397637,
1920301951,1921309633,1922092567,1922687293,1923224689,1923311317,1923845801,1928903971,1930534453,1930915169,
1934350351,1938264241,1943951041,1950987193,1957705177,1959659857,1960708261,1965007601,1968002149,1970065681,
1988965861,1991063449,1995830761,1996231189,1996339649,1997844157,1999053601,1999111801,2007646961,2013554869,
2016481477,2017021333,2017509601,2021392369,2021884343,2028279793,2028812399,2029830409,2036224321,2049293401,
2050617713,2052149221,2055634561,2057835781,2062612033,2068867841,2076192007,2081039297,2081551753,2082146617,
2086645009,2093300401,2095627153,2096046457,2100292841,2101744837,2104994449,2107148761,2114643217,2115769633,
2116483027,2116541221,2117031263,2117555641,2118621097,2120096161,2123601751,2124691213,2127197489,2129304997,
2131811501,2140771609,2141340833,2144961253,2147418113,2152627801,2155416251,2172155819,2173540951,2173579801,
2175126601,2175406201,2177645557,2185362233,2187717761,2200115713,2201924341,2202205897,2203649197,2206095589,
2210578759,2213431729,2216960929,2217879901,2229468697,2231332357,2241880033,2241982009,2246762899,2251732033,
2256748777,2256751837,2262861901,2269307587,2274584089,2283289681,2284416181,2289251669,2290910257,2292068143,
2295209281,2296995121,2300795353,2309241601,2311558021,2311575001,2315137261,2320527613,2323147201,2324867399,
2330569541,2331181621,2335341601,2338157597,2340460487,2345907961,2347597981,2352371251,2354453561,2355230749,
2355622721,2355735089,2370928337,2372976563,2375415841,2381782597,2382678101,2385574201,2389544977,2394311233,
2398393661,2411128441,2412172153,2413973071,2428648967,2430697513,2431144801,2432761633,2432860273,2433791593,
2434974433,2435091221,2437907779,2438778413,2443708961,2448039497,2471205361,2473120961,2473189441,2474676949,
2476283239,2477814193,2478643907,2480147521,2482435981,2482682131,2484408301,2488420801,2492480233,2494660033,
2495834329,2499327041,2501012599,2502525637,2506733189,2507121037,2508178843,2513230891,2519297089,2526566041,
2528291341,2529827821,2530351561,2532630787,2533465661,2533797017,2537105761,2539406281,2541660367,2542479481,
2545934077,2550780277,2551365769,2555391481,2561945401,2565186137,2571180247,2575060949,2582952769,2584460701,
2588582089,2597294701,2602343521,2602378721,2604803701,2611122229,2611461529,2617563031,2621080741,2621977627,
2625903601,2626783921,2627284987,2632605049,2634284801,2634804481,2634820813,2639099233,2642159809,2642582251,
2646751249,2648662777,2649907201,2651507713,2656494271,2658696301,2668469431,2672605657,2672651521,2681041843,
2682823681,2683742491,2684284441,2687655169,2688124001,2693739751,2695115473,2700818017,2700891839,2701878941,
2704957909,2706863833,2707661501,2716157989,2716275007,2717428033,2721721939,2725357249,2736316301,2738184697,
2753333227,2759392633,2765323397,2766006253,2767672189,2769080161,2769602333,2777887297,2778304273,2781117721,
2800352011,2809635901,2823570433,2824256377,2824804693,2828205397,2832743713,2837917633,2840634109,2840871041,
2847894377,2848466281,2848722131,2855512909,2866005139,2866527841,2871536561,2872948321,2874382853,2877769501,
2881429741,2882370481,2885594497,2890316801,2890414873,2895004927,2899294889,2903776129,2916247819,2918295451,
2920691161,2929106753,2930831641,2931708097,2932327549,2936227603,2936958181,2941343633,2944555681,2945208001,
2951136343,2956724317,2957320351,2965700233,2968206601,2974506841,2986025677,2993462713,2994098281,2994415201,
2998202353,3004443679,3014101261,3015502181,3016957381,3018147217,3018576689,3025350343,3028586471,3035375047,
3036079729,3037295801,3037781251,3038880473,3039681457,3041984353,3050190163,3056100623,3057886591,3058670677,
3059397793,3063685633,3065998717,3082054697,3083053387,3083537689,3083884651,3094763851,3103800701,3114125071,
3120445697,3122287981,3133899409,3145410761,3150972917,3156599161,3156643141,3166504273,3172658653,3175204531,
3175255717,3181356263,3182606857,3182655361,3187035113,3187421077,3187939921,3197565001,3197911001,3199164901,
3207297773,3208902491,3215031751,3219808411,3222693421,3227082823,3227209057,3237992101,3242533897,3248236309,
3250348417,3252148621,3257334541,3258647809,3261114601,3263097641,3263626957,3265122451,3267417677,3268506541,
3274264033,3275671969,3278640289,3282974857,3287174129,3288757249,3295362727,3296403601,3299246833,3302322241,
3305829073,3306686659,3306957593,3312536569,3315139717,3320669437,3323590463,3323829169,3328354801,3334350781,
3340214413,3344191241,3346172189,3349218881,3352091557,3355382857,3369139201,3371024521,3371693063,3381052177,
3385842877,3386603221,3387487351,3389030261,3395091311,3399205591,3402234749,3407772817,3407952169,3408135121,
3411829693,3415379701,3415832137,3417522841,3420143941,3423580481,3427050673,3428133103,3429982081,3430804297,
3432695921,3433458073,3434575327,3435973837,3443704261,3449768513,3450717901,3458257741,3464236901,3466158361,
3470716657,3482161261,3492178873,3492883081,3504132113,3512291021,3513604657,3519318721,3524086333,3525088961,
3529119361,3529864391,3533662129,3533856913,3538213381,3542303047,3548378341,3552158521,3553567057,3557646401,
3562963973,3563340457,3566428301,3574891757,3583249921,3583604161,3586833253,3587553971,3590409439,3594110081,
3596491907,3596815169,3605151241,3612298321,3614770573,3628526287,3630596257,3651572609,3662387977,3662503093,
3663084541,3669587533,3672754633,3679657997,3685775741,3692307161,3695628133,3697278427,3700801861,3705582073,
3708123301,3708905341,3709626961,3712887289,3713287801,3723699373,3725016749,3729097633,3733761739,3746101189,
3749383681,3751782737,3754680403,3756668401,3760622689,3762110881,3767640601,3798040471,3798626833,3800084401,
3805699501,3807308269,3807749821,3809018947,3813919453,3817706621,3827035237,3846174151,3846532801,3847106803,
3852800033,3863326897,3865604023,3867183937,3874471147,3874523017,3875096893,3886515361,3887423437,3891892421,
3894053311,3897241129,3897869201,3900327241,3903711841,3905533721,3907577521,3907752241,3914880337,3914923211,
3918227437,3922321561,3926912669,3935864017,3947383201,3953408801,3958930441,3959578801,3966350203,3979485931,
3987528793,3987960913,3991124341,3992697997,3997536427,4005660961,4011996871,4015548769,4034969401,4034993269,
4036395581,4042538497,4044601751,4048493983,4058433931,4060942381,4061009971,4064633821,4067039461,4071644893,
4076009857,4079665633,4079682361,4083376067,4098258707,4100934241,4103745689,4108970251,4109461709,4110320663,
4113013141,4115891893,4117058221,4117447441,4121286907,4127050621,4129914673,4139015987,4155375349,4157008813,
4166032873,4183664101,4186561633,4187360341,4191864013,4192060699,4195843037,4196323561,4204344601,4206006229,
4206295433,4212105409,4218900001,4232966251,4234224601,4237212061,4244022301,4244663651,4247990917,4250920459,
4251904273,4255695013,4271267333,4275011401,4277526901,4278305651,4282867213,4294901761,
 ];
 
 const PSEUDOLARGE : [u32;1616] = [
 33227,96049,218791,226801,250717,267859,289787,290629,369847,382537,387001,
398413,416641,438751,470137,504913,512177,578771,579233,585631,597871,
635077,679583,693307,753251,753667,765703,767419,865373,871561,874039,
876961,1044469,1056331,1092631,1297741,1314631,1335427,1368541,1380751,1416169,
1445377,1449037,1466609,1492663,1496881,1534909,1940681,2026291,2030341,2035153,
2082781,2091181,2227091,2424509,2524801,2821129,2943851,3030311,3167539,3242737,
3377551,3487681,3572381,3766561,3815011,4024081,4045627,4064677,4178539,4440977,
4480477,4561481,4920301,5122133,5160013,5167117,5181931,5194051,5292631,5351537,
5389129,5674051,5722289,5811271,6038309,6188473,6255091,6330721,6578941,6671611,
6955541,7211153,7232321,7423771,7593697,7686401,7801273,8108941,8270333,8333333,
8543767,8678281,8902741,8924891,8952763,9080191,9363733,9490501,9493903,9533701,
10217353,10419679,10792531,10837601,11407441,11679211,12118289,12119101,12132343,12159073,
12539507,12935557,13012651,13292911,13404751,13544161,13773061,13821193,14019391,14497267,
14783203,14792971,15576571,16120021,16126463,16508501,17013289,17300161,17349307,17527649,
18761401,19212821,19320073,19732897,19927081,20227201,20272253,20633167,20794483,20857229,
20904799,21399247,22028203,22035917,22238173,22269739,22409269,22463461,22533761,22902941,
22912261,22994371,23344021,24482503,25201243,25203251,25342411,25525499,25768261,25889473,
25971691,26098433,26272457,26678161,27191011,27441577,27956503,28406953,28647253,28666331,
28989871,29506843,30932521,30971711,31314193,31485061,31530469,31698791,31720313,31817633,
31988857,32068189,32164801,32653363,33030589,33503933,34043101,34084181,34516561,34694941,
34890481,35420477,35732497,36509617,36578473,37577539,38120041,39371141,39547171,39808651,
39829591,40621591,41027227,41425201,41710411,42311671,43036003,43060091,43248871,43571753,
43838341,43893937,45175201,45444881,45865873,46094401,46728533,47131657,47248961,47385631,
47494093,47632513,47925121,48581149,48612527,50581081,51088133,51627817,52344073,52599259,
52798337,53070271,53287081,53483431,53954881,54069517,54585313,55170529,55681291,56002321,
56417467,56495221,57199501,58679941,58725703,58980637,59169661,59702281,60033403,61567091,
61572421,61754941,61808293,62399041,62457833,63354139,64223461,64664917,65274751,66124001,
66603253,66725209,68609461,69600833,72526049,73031837,73963501,73981657,74305723,74740051,
75663451,75709763,75828413,75888037,76487693,76812689,77315561,77555713,77622533,77781241,
77830681,77940773,79464533,79624621,80826121,81129553,82929001,84354821,86277859,86333353,
86854721,88469929,89517299,89532271,90970133,91116439,91935947,92438581,92746807,92983381,
93294433,95068891,96783151,96878101,97076017,98289001,100072171,101547217,103042241,103518601,
103788301,103983907,104220703,106374071,107486413,107772211,107811527,109427291,109838431,110436481,
110631841,111540001,112177217,112702591,112996747,113890129,114516751,116151661,117186037,117308977,
117662981,117695843,118566533,119053897,119077369,119383171,120561319,120624277,120811241,121299391,
122853613,123242191,123608981,124803251,127028513,127535651,128200253,129205781,130285171,131032969,
131515129,131881429,136545067,136685897,137200981,137996147,138027943,138653101,139932509,140337521,
141282181,143106133,145139209,145206361,145377277,145410931,146021633,147683593,148652767,150331837,
150466273,151149553,151775867,152968241,152995307,153702137,154011467,154384501,154430459,154560431,
154586881,155161843,157790023,158104801,159270589,162261943,163892587,164411911,164577043,165733681,
166269251,166339057,167472451,167557909,167786401,168156649,169086341,169500833,169603351,170584961,
171051359,171573421,172018667,173401621,173678203,173961943,174635011,176207221,176977921,177439061,
177455701,177811129,177949171,179124013,179127451,181992961,182375971,184071581,184778917,185653333,
186568471,187248307,187546133,188985961,189339697,190934371,190999591,191010133,192387541,193008223,
193133557,193374451,194389903,194913217,195664571,195755953,196100623,199104533,199162861,199452637,
200100781,200437519,201789127,203071903,204051997,204697429,205586803,208483777,210958777,211969603,
214038533,214314277,214616953,215902993,216821881,216899047,217396481,217472501,217522561,217646017,
219802589,220079689,220471841,221340421,221793391,222065021,223024783,223051141,223631521,223947571,
224486081,224582221,226269601,226366003,226720777,227132641,227753821,228233737,228988033,230938723,
233787919,233818729,236566591,237463717,237719311,238200901,239806183,239983153,240008911,240141287,
240272077,240371083,241370179,242225551,242348941,242647921,243200299,245497669,246560651,247215341,
247232441,248152273,248152843,248270773,248290927,249679501,250161601,251356291,253158751,258404999,
258757201,259092793,263025823,264989089,266614979,266925601,268361641,268505551,268908481,270783251,
270868561,271616311,273287783,274335251,274937851,277477903,280946773,281288801,286854947,289759051,
289760833,290435749,291190681,292290181,294207401,297624961,298192753,298237741,302818001,307849741,
310693633,312199213,312485167,312542491,312754037,314154937,314311603,316032721,316525483,317173159,
318026801,318158041,318465703,319167157,320048569,321117037,322725001,324264943,325837081,327330329,
327626017,333116551,334291981,334793551,334872721,335304691,338776111,343443479,344525633,346305403,
346414231,346859521,351843049,351910021,353722513,358243861,359112857,361032611,362474209,363245581,
363738553,363830573,367885513,369699943,369913279,370740833,372432451,373782601,374753633,375357163,
379270651,379352401,386873419,387503957,393613081,394440301,395207107,396106261,396717319,396755713,
398294821,398864881,398866513,399138793,399671641,400385701,401305057,402918157,403689313,404191231,
407626267,409803497,411233167,411391801,411589417,414027781,414452677,415108891,415365481,416476747,
417736483,421114861,421277653,421830481,424027711,429802001,429890581,437247841,439714133,443121001,
443129311,443492029,443688649,445601539,450773443,451582231,454828637,459132763,460486921,460816957,
463628551,464912839,466403081,467083399,467471959,467575501,470120257,471168253,471392137,473516101,
475178401,475969231,479398501,479902541,480008021,481828177,481960201,483459181,485112241,486572747,
488287801,488640577,488656981,495832231,499411981,500398669,500646907,503149601,506427247,507520133,
507565229,509299577,512421523,513921493,516502561,517555711,518504533,519304921,519386683,525555553,
528991921,530172127,530286529,530630701,531580349,532094413,533818531,536003333,538576657,539606773,
541158853,545670533,545738203,546698681,546794329,547642591,549162511,552163333,553904677,554396131,
556056601,557058133,557876479,558409441,560740237,560907271,565503233,566922049,567815617,568528957,
570423751,570692989,571765321,572714497,575419021,577078261,578185301,578191849,580786331,583149991,
589743577,590488001,592953901,595510393,600929129,605953261,608016599,613353253,614071751,614120113,
614145853,619088521,629789357,630888481,632278081,639741061,641490697,641601871,644453633,646947163,
656723161,656793899,656824033,657219631,659437201,662090707,662200351,662853151,667578871,667593313,
673218817,676323071,676623569,676936751,678452923,679358377,685713029,686031781,686333953,689842759,
689928191,690875071,693212521,696042901,696102401,696447181,697791403,699322423,700079041,701241451,
703500271,703644763,705883951,706770637,708230473,710583719,710617861,710988427,711215371,712915969,
713302129,713946133,718092607,719818321,721741453,722229091,722687941,723759781,725871301,726679409,
728028319,729090001,729491071,730364137,732525553,734316049,735774661,740142811,741182401,744312367,
745170229,747104311,749216521,752186593,757272707,758081801,758798657,761260603,766228783,767765513,
768916661,771063991,774027781,774301681,774512803,775136251,778247861,780457399,783326377,785008261,
785190451,787935751,788828059,789707707,799525063,802477453,802548377,803063201,804971441,812093257,
815430533,815935759,818874541,821920409,822185519,826945621,832656701,832870891,833091631,833267737,
833746321,834798109,842220289,843064531,845425813,846440417,847027063,848826331,850330241,850678363,
852208219,853068511,853799059,857100421,860988169,870559777,871908481,875207869,878607031,884584891,
888820291,900546167,901406801,901540657,902457137,905533487,911366167,918023891,919233151,920581121,
924136051,925198081,925934683,928185961,928742413,928766257,929363251,933554551,934318097,938030101,
939059749,939482729,944832533,956144419,957200917,957600541,959189149,961504589,962049089,962375941,
965291111,968978161,970560533,974787857,978359617,979535537,981545797,981748811,982312907,992161981,
992853881,995793397,999165691,1001549221,1002071071,1003613311,1007713171,1012911409,1015269391,1015753601,
1016191607,1016250247,1022271769,1024605121,1026583801,1026734551,1027938013,1028316041,1031268961,1032101461,
1039480129,1040295691,1041509251,1052249761,1052487437,1054740191,1056013351,1060507537,1063021321,1070158877,
1073496997,1078154101,1081531531,1083174283,1084784887,1085117101,1085552681,1087351393,1087526497,1092902533,
1092995047,1098250921,1110018127,1112967991,1114710097,1114915729,1115067061,1120721249,1123339981,1126262173,
1127993861,1129390421,1129689793,1130256181,1133165563,1133723779,1135577953,1138949533,1142300503,1145953841,
1146584251,1150774579,1153260343,1157445451,1157724577,1160920129,1161562823,1161764869,1166240833,1171035251,
1171874159,1174264813,1182810953,1185495599,1188297631,1189817371,1195437293,1196470801,1202207137,1203801103,
1205575369,1206720397,1207388009,1209030007,1212479399,1212858979,1213347691,1217845661,1222568707,1234646533,
1238018797,1238325001,1241348791,1244664361,1246605473,1248094273,1249001731,1260782161,1265099617,1266745369,
1267133311,1267999861,1270946101,1271735011,1280512801,1284706057,1289281621,1293777151,1293845801,1302145267,
1304553251,1305611959,1317157217,1320072851,1324344341,1325168461,1325697199,1333215703,1334083273,1338579257,
1343065147,1350371821,1352600201,1356241321,1362064573,1364320729,1373452033,1375436801,1376483627,1381917109,
1383453919,1384219009,1386258443,1386431689,1390971013,1399619131,1401555763,1403772581,1408610503,1408630241,
1416686641,1418951689,1419942541,1424941601,1426735501,1427543041,1427845987,1432657211,1432852711,1438334983,
1440231941,1442791981,1444441861,1445502997,1445805343,1455060097,1458366551,1464953527,1465043599,1468622773,
1470336583,1476555931,1478049541,1484620201,1489587997,1490056501,1492617001,1497177631,1498117697,1507101971,
1508642701,1509849181,1510352929,1516134457,1517219617,1518667561,1521620101,1522498429,1528643971,1533555271,
1538331463,1540030273,1541337631,1549340801,1551633931,1552636807,1552891201,1553993263,1554448901,1561154521,
1561800833,1562507371,1569048571,1586864761,1587766753,1588472341,1602820873,1605489541,1606749061,1608087119,
1611615151,1616387653,1618587001,1621749377,1623098401,1624305121,1626103513,1635326969,1635548221,1642680139,
1646710099,1651655399,1654754011,1663267579,1674658133,1675383631,1678151707,1679742517,1682400259,1684579933,
1687326871,1688482643,1697344801,1698407677,1703562761,1713319453,1715427451,1719147193,1728248887,1728960133,
1729369651,1731474379,1736610739,1742896213,1750533121,1753802213,1757296861,1760746501,1769323271,1772877943,
1775452433,1778046271,1791815873,1805555201,1806761591,1807751977,1816782661,1817457121,1820116561,1820306953,
1826830441,1828182427,1832144623,1838145401,1838453203,1840915007,1858466611,1862251597,1862829169,1863332659,
1868076451,1876900481,1877051441,1882049977,1883255833,1885680961,1902631447,1904152141,1904758369,1907221681,
1919474281,1921746049,1921786001,1922036539,1924975879,1926888433,1932808963,1933811791,1937105941,1941454657,
1944023621,1944230401,1945335013,1950645187,1955219311,1962730531,1963787239,1975247539,1977571909,1978554121,
1992813551,2001635143,2003569501,2005360351,2005989121,2028160373,2030255173,2032340977,2039884153,2046528013,
2046624977,2049112301,2049700841,2050195379,2050780507,2052867931,2056570679,2058072041,2062074431,2063228203,
2065840171,2079852923,2080995841,2082334321,2086236181,2087028067,2095990081,2099912501,2101378621,2103581521,
2123112967,2130134533,2131620571,2131764653,2143585621,2144294857,2147366527,2159484757,2162323351,2164825937,
2170185517,2170186021,2198142871,2205763129,2214761251,2221840237,2223279671,2229152923,2231794681,2233031701,
2233350271,2233412261,2234202049,2241674453,2242724851,2248028161,2257303031,2269954303,2278001101,2282304361,
2285660833,2289033739,2291202439,2295654937,2296116689,2299104953,2301745249,2301980801,2306102191,2306508679,
2308045771,2319456637,2326006909,2329584217,2339783233,2345191729,2345428321,2357265569,2371481221,2373443749,
2375108339,2378844043,2383466941,2384804129,2390272421,2395568701,2396127817,2402429389,2403352451,2408160641,
2408186401,2422236601,2433614569,2434525801,2439743489,2448390907,2455840141,2461871497,2463879497,2474396893,
2481309811,2481403601,2481672581,2484361573,2496389551,2501960501,2503044613,2503327549,2510495989,2515436251,
2525070241,2527586417,2532010139,2533550707,2533915781,2537548241,2538430651,2551898291,2560600351,2563596751,
2568836467,2572151401,2575080397,2577345541,2597788951,2602852181,2609294101,2618760031,2620691509,2626769521,
2643150061,2644235941,2646147001,2656484507,2659939453,2665047871,2674192993,2674839511,2686816133,2697070361,
2697865057,2703521141,2705760829,2705912357,2712456601,2714452177,2716305643,2723504059,2728558867,2739606451,
2746882669,2752071001,2754895609,2755700201,2760415813,2761099111,2763949033,2767384567,2771719651,2772059687,
2774786873,2776669663,2777289061,2779477741,2782315201,2798992811,2800172953,2801128961,2804783533,2807354881,
2809347881,2812435211,2813512591,2815816033,2822521411,2823828187,2828698133,2838534337,2839992427,2841190381,
2842924639,2844363329,2845986391,2846752291,2852595517,2854715263,2857919401,2864687951,2866872781,2873515969,
2874627649,2884777601,2890723657,2890870973,2898023521,2915365051,2929892041,2930955721,2934471791,2935257781,
2940427001,2943492529,2944812319,2945960033,2960791289,2964259489,2971787141,2975096953,2992394501,3005201359,
3005851031,3008240861,3009756751,3016485001,3017294957,3019208977,3040651967,3044527477,3047600641,3048323041,
3048467381,3054297403,3054297997,3058129621,3063683503,3074083651,3075078947,3082491259,3089749969,3100485943,
3119786983,3121477633,3121936271,3127811527,3136700729,3148403959,3162644119,3168870541,3169830751,3170060683,
3180143761,3185944273,3190544677,3192323681,3197280571,3208453687,3210223249,3210690169,3218821007,3223238401,
3226135859,3226864033,3258603811,3263529691,3271921633,3277759123,3280593611,3297180811,3300005537,3301251949,
3309587569,3322130111,3324006533,3330940001,3331867127,3335172947,3336921191,3350103301,3358551043,3364559491,
3374598781,3381279949,3384004231,3384800641,3397422541,3402839441,3415854961,3417451363,3429457921,3430056151,
3436339201,3438150497,3441666181,3442964671,3445470001,3446328913,3450935503,3458216917,3462089581,3462817177,
3480908203,3484936729,3485894371,3496558301,3499594261,3501194797,3502814401,3517984513,3521086181,3555172493,
3559983281,3575397911,3577077533,3590126777,3591204481,3593551937,3595184321,3596337361,3601806251,3602550451,
3602640997,3606377149,3608134993,3614283451,3617369911,3620047117,3621992533,3622784497,3634084871,3640031081,
3652672789,3653628247,3656511073,3672050999,3672550969,3672678673,3684265621,3710443249,3711225751,3712636861,
3730423261,3737274371,3737920621,3747435737,3754229491,3754262401,3754390741,3755587681,3757894229,3759781369,
3768962779,3769509041,3776657743,3783402481,3787052221,3787087921,3789843461,3794631779,3796556761,3802283311,
3805701901,3806670421,3820951681,3830971561,3835537861,3841859323,3843287351,3863775137,3870667639,3878450413,
3882729131,3883750471,3887635753,3888802171,3894748001,3899355461,3901632313,3905425481,3908413559,3916876759,
3917848663,3933106717,3964220371,3967343161,3971095301,3972014401,4024335841,4041356801,4042578403,4065220699,
4065650681,4070654389,4070776711,4086437587,4099200689,4114542361,4125787121,4136040199,4143633751,4144945351,
4156580741,4157375023,4162064407,4168807777,4175289271,4177194421,4177326941,4178124343,4183901261,4192437971,
4196563681,4233808153,4234133251,4235847361,4236658021,4256020451,4259605789,4263649699,4265045797,4269987307,
4270688173,4271121161,4277967709,4282561219,4285858523,
];
 
 

  // 203280221primes counted in 565.992596603s
  fn main() { //1211.754987777s                ln for 1 million digits in 142.926623269s
     let mut count = 0u64;
     let timer = std::time::Instant::now();
     for i in 0..100_000_000u32{
       if trial_prime(i,2){
         count+=1;
       }
     }
     let stop = timer.elapsed();
     
     println!("{} primes counted in t: {:?}",count,stop)
     
     }
      /*
 

base 9555 is the strongest candidate                                  11079471 78.188396602s         real value 11078937 primes under 200 million

                                 Execution for the first 20 million    200 million
2-base first error is 2047            1270836 6.081703702s           11079588 80.792609022s
4253-base first error is 2127         1270896 6.191073982s
4414-base first error is 2207         1270892 6.19865271s
12289-base first error is 2329        1270892 6.446237128s
20612-base first error is 4681        1270801 6.384369802s           11079485 84.98605898s
74722-base first error is 7421        1270838 6.615589368s
621862-base first error is 7957       1270819 6.68702704s
1329052-base first error is 11671     1270839 7.875698924s
1771072-base first error is 12209     1270833 7.780485489s
2974927-base first error is 18721     1270860 9.141408159s
8284883-base first error is 22177     1270810 7.182930145s
56202142-base first error is 26599    1270807 7.105427875s
1027938013-base first error is 29341  1270811 6.971780823s            11079504 85.073606473s  



2-base first error is 42799
3-base first error is 79003
5-base first error is 79381
45-base first error is 96049
56-base first error is 118301
68-base first error is 192221
2483-base first error is 197633
5319-base first error is 218791
11247-base first error is 286903
1062514-base first error is 288163
1412896-base first error is 318553
5815432-base first error is 332831
17337765-base first error is 358559
19393650-base first error is 398413
50561506-base first error is 408851







11079452 23.10638594
11079364 22.713330607s


50848453 128.427211299s
Base           Pseudocount    time              Delta_prime

2               203282260    546.120625692s      2039
19393650        203281915    582.549397211s      1694
17337765        203281888    577.313059561s      1667
50561506        203281891    567.295878175s
1027938013      203281885    581.424773784s      1664



320437 filters 183

2 filters 125


      */
      
    
    
    
 
